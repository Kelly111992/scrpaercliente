name: Keep Workflow Alive

# This workflow prevents GitHub from disabling scheduled workflows
# GitHub automatically disables scheduled workflows on repos with no activity for 60 days

on:
  schedule:
    # Runs every 50 days to keep the workflows active
    - cron: '0 0 */50 * *'
  
  workflow_dispatch:
    # Allow manual trigger

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    permissions:
      actions: write
    
    steps:
      - name: Keep workflows alive
        uses: actions/github-script@v7
        with:
          script: |
            // This creates an empty commit-like activity to keep the repo active
            console.log('✅ Keeping scheduled workflows alive');
            console.log(`Repository: ${context.repo.owner}/${context.repo.repo}`);
            console.log(`Timestamp: ${new Date().toISOString()}`);
            
            // Re-enable workflows if they were disabled
            const workflows = await github.rest.actions.listRepoWorkflows({
              owner: context.repo.owner,
              repo: context.repo.repo,
            });
            
            for (const workflow of workflows.data.workflows) {
              if (workflow.state === 'disabled_inactivity') {
                console.log(`Re-enabling workflow: ${workflow.name}`);
                await github.rest.actions.enableWorkflow({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  workflow_id: workflow.id,
                });
              }
            }
            
            console.log('✅ All workflows checked and enabled');
